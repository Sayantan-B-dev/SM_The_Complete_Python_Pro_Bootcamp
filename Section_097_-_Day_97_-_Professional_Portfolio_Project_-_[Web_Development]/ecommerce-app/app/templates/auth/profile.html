{% extends "base.html" %}

{% block title %}My Profile - Art Ecom{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto space-y-6 fade-in">
    <h1 class="text-5xl font-light mb-8">My Profile</h1>
    
    <div class="glass-card p-8">
        <h2 class="text-2xl font-light mb-4">Account Information</h2>
        <div class="space-y-2 text-white/70">
            <p><span class="metadata">Email:</span> {{ current_user.email }}</p>
            <p><span class="metadata">Member since:</span> {{ current_user.created_at[:10] if current_user.created_at else 'N/A' }}</p>
        </div>
    </div>

    <div class="glass-card p-8">
        <h2 class="text-2xl font-light mb-4">Order History</h2>
        {% if orders %}
            <div class="space-y-4">
                {% for order in orders %}
                <div class="border border-white/10 rounded-xl p-4">
                    <div class="flex justify-between items-center mb-2">
                        <span class="metadata">Order #{{ order.id }}</span>
                        <span class="text-sm text-white/40">{{ order.created_at[:10] }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <div>
                            {# Safely iterate over items, default to empty list if missing #}
                            {% for item in order.get('items', []) %}
                            <div class="text-sm">{{ item.product_name }} x {{ item.quantity }} @ ${{ item.price }}</div>
                            {% endfor %}
                        </div>
                        <div class="text-right">
                            <span class="text-lg font-light">${{ order.total_amount }}</span>
                            <span class="ml-4 px-3 py-1 rounded-full text-xs 
                                {% if order.status == 'paid' %}bg-green-500/20 text-green-400
                                {% elif order.status == 'pending' %}bg-yellow-500/20 text-yellow-400
                                {% else %}bg-red-500/20 text-red-400{% endif %}">
                                {{ order.status }}
                            </span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-white/40">No orders yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}